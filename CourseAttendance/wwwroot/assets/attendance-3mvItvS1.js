import{r,j as s,z as l}from"./index-DMSo9A6b.js";import{U as i}from"./httpInstance-C55ZiIOL.js";import{S as p}from"./index-DMUYR7cW.js";import{u as ie}from"./auth-CTiWA_Us.js";import{u as he}from"./major-D6_qL6Fl.js";import{T as N,A as Se}from"./AttendanceTable-B6iK8g-n.js";import{S as y}from"./Table-COrzr-N3.js";import{D as P}from"./index-MTgV4XfQ.js";import{B as de}from"./button-C9aunvGq.js";import{S as k}from"./index-CECpZ8oT.js";import"./Compact-9-DoedRz.js";import"./useVariants-BrrpPftB.js";import"./row-BjMCkrL4.js";import"./addEventListener-CAP49bzj.js";import"./EllipsisOutlined-lrZK_o1q.js";import"./Overflow-B3sfSCiy.js";import"./index-BBBze9MX.js";import"./index-BiFZ309z.js";const Ue=()=>{var E,B,T,U,H,I;const[F,S]=r.useState(1),[O,b]=r.useState(""),[R,f]=r.useState(""),[_,x]=r.useState(""),[o,d]=r.useState(null),[n,m]=r.useState(null),[j,q]=r.useState(void 0),[M,z]=r.useState(void 0),c=ie(),v=he(),[Q,w]=r.useState(!1);r.useEffect(()=>{G()},[]);const G=async()=>{await h(),V(""),C("")},h=()=>{w(!0)},J=t=>{b(t.target.value)},K=async(t,e,a)=>{(a==null?void 0:a.source)=="input"&&(b(t),S(1),await h())},L=t=>{f(t.target.value)},W=async(t,e,a)=>{(a==null?void 0:a.source)=="input"&&(f(t),S(1),await h())},X=t=>{x(t.target.value)},Y=async(t,e,a)=>{(a==null?void 0:a.source)=="input"&&(x(t),S(1),await h())},Z=t=>{if(!t){d(null);return}let e=(o==null?void 0:o.clone())??l();e=e==null?void 0:e.year(t.year()),e=e==null?void 0:e.month(t.month()),e=e==null?void 0:e.date(t.date()),d(e||null)},$=t=>{if(!t){d(null);return}let e=(o==null?void 0:o.clone())??l();e=e==null?void 0:e.hour(t.hour()),e=e==null?void 0:e.minute(t.minute()),e=e==null?void 0:e.second(t.second()),d(e||null)},ee=t=>{if(!t){m(null);return}let e=(n==null?void 0:n.clone())??l();e=e==null?void 0:e.year(t.year()),e=e==null?void 0:e.month(t.month()),e=e==null?void 0:e.date(t.date()),m(e||null)},te=t=>{if(!t){m(null);return}let e=(n==null?void 0:n.clone())??l();e=e==null?void 0:e.hour(t.hour()),e=e==null?void 0:e.minute(t.minute()),e=e==null?void 0:e.second(t.second()),m(e||null)},ae=async()=>{S(1),await h()},[u,re]=r.useState([]),[se,A]=r.useState(""),V=async t=>{A(t);const e=v.majorsCategories.map(a=>({label:a.name,value:a.id}));re(e||[])},oe=t=>{var e;q(t),A(((e=u==null?void 0:u.find(a=>a.value==t))==null?void 0:e.label)+""),C("",t)},[ne,ue]=r.useState([]),[ce,D]=r.useState(""),C=async(t,e=j)=>{if(D(t),!e)return;const a=v.majorsSubcategories.filter(g=>g.majorsCategoriesId==e).map(g=>({label:g.name,value:g.id}));ue(a||[])},le=t=>{var e;z(t),D(((e=u==null?void 0:u.find(a=>a.value==t))==null?void 0:e.label)+"")};return s.jsxs(y,{direction:"vertical",style:{width:"100%"},children:[s.jsxs(y,{children:[s.jsx(p,{placeholder:"输入查询的课程名",onSearch:K,enterButton:!0,onChange:J}),(((E=c.user)==null?void 0:E.roles.includes(i.Admin))||((B=c.user)==null?void 0:B.roles.includes(i.Academic))||((T=c.user)==null?void 0:T.roles.includes(i.Student)))&&s.jsx(p,{placeholder:"输入查询的老师名",onSearch:W,enterButton:!0,onChange:L}),(((U=c.user)==null?void 0:U.roles.includes(i.Admin))||((H=c.user)==null?void 0:H.roles.includes(i.Academic))||((I=c.user)==null?void 0:I.roles.includes(i.Teacher)))&&s.jsx(p,{placeholder:"输入查询的学生名",onSearch:Y,enterButton:!0,onChange:X}),s.jsx(P,{onChange:Z,placeholder:"开始日期"}),s.jsx(N,{onChange:$,defaultOpenValue:l("00:00:00","HH:mm:ss")}),"-",s.jsx(P,{onChange:ee,placeholder:"结束日期"}),s.jsx(N,{onChange:te,defaultOpenValue:l("00:00:00","HH:mm:ss")}),s.jsx(de,{type:"primary",onClick:()=>ae(),children:"查询"})]}),s.jsxs(y,{children:[s.jsx(k,{showSearch:!0,placeholder:"输入搜索大专业名称",options:u,value:j,onChange:oe,onSearch:V,searchValue:se,optionFilterProp:"label"}),s.jsx(k,{showSearch:!0,placeholder:"输入搜索细分专业名称",options:ne,value:M,onChange:le,optionFilterProp:"label",onSearch:C,searchValue:ce})]}),s.jsx(Se,{dataUpdate:Q,onDataUpdated:()=>w(!1),queryStr:O,teacherName:R,studentName:_,startTime:o,endTime:n,majorsCategoryId:j,majorsSubcategoriesId:M,current:F})]})};export{Ue as default};
