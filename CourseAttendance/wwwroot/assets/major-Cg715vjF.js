import{r as n,j as x}from"./index-RoQaJWNr.js";import{j as y,e as _,M as $}from"./httpInstance-d9YVvvpr.js";const u=n.createContext({}),I=({children:m})=>{const[j,p]=n.useState([]),[C,g]=n.useState([]),[M,l]=n.useState([]),[S,f]=n.useState([]);n.useEffect(()=>{d()},[]);const d=async()=>{const s=await b(),e=await L(s),c=(await w()).map(o=>{const a=e.find(i=>i.id==o.majorsSubcategoriesId),r=s.find(i=>i.id==(a==null?void 0:a.majorsCategoriesId));return{name:`${o.year}级-${r==null?void 0:r.name}-${a==null?void 0:a.name}-${o.num}班`,id:o.id||-1}});f(c)},w=async()=>{var e,t;const s=await y.apiClassesGet();return l(((e=s.data.data)==null?void 0:e.dataList)??[]),((t=s.data.data)==null?void 0:t.dataList)??[]},L=async s=>{var c,o;const t=(o=(c=(await _.apiMajorsSubcategoryGet(void 0,1,9999)).data.data)==null?void 0:c.dataList)==null?void 0:o.map(a=>{const r=s.find(v=>v.id==a.majorsCategoriesId),i=a;return i.parentName=(r==null?void 0:r.name)||"",i});return g(t??[]),t??[]},b=async()=>{var e,t;const s=await $.apiMajorsCategoryGet(1,9999);return p(((e=s.data.data)==null?void 0:e.dataList)??[]),((t=s.data.data)==null?void 0:t.dataList)??[]};return x.jsx(u.Provider,{value:{majorsCategories:j,majorsSubcategories:C,classes:M,classesStr:S,update:d},children:m})},P=()=>n.useContext(u);export{I as M,P as u};
