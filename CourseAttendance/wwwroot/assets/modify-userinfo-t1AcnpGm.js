import{r as l,j as a}from"./index-ZtOdBFYM.js";import{A as y,U as R}from"./httpInstance-BCqN5o7-.js";import{u as v}from"./major-QJTBo71x.js";import{F as s,I as n}from"./index-BACqsOj-.js";import{S as w}from"./index-CmPTCLLR.js";import{B as P}from"./button-DZBOrXaR.js";import"./Compact-CvTKlge1.js";import"./useVariants-BrNfV6O7.js";import"./row-qe9Z4i1C.js";import"./Overflow-D3Zk1A28.js";const L=()=>{l.useEffect(()=>{C()},[]);const C=async()=>{var t,h,x,S,f,j,g,E,I,b;var e=await y.apiAccountProfileSelfGet();const r={email:(t=e.data.data)==null?void 0:t.email,phone:(h=e.data.data)==null?void 0:h.phoneNumber,name:((x=e.data.data)==null?void 0:x.name)||"",userName:((S=e.data.data)==null?void 0:S.userName)||"",roles:((f=e.data.data)==null?void 0:f.roles)||[],createAcademicExt:{},createAdminExt:{},createStudentExt:{gradId:((g=(j=e.data.data)==null?void 0:j.getStudentExt)==null?void 0:g.gradeId)||-1},createTeacherExt:{}};m.setFieldsValue(r),d(""),u(((I=(E=e.data.data)==null?void 0:E.getStudentExt)==null?void 0:I.gradeId)||-1),A(((b=e.data.data)==null?void 0:b.roles)||[])},[m]=s.useForm(),F=async e=>{try{console.log(e),await y.apiAccountUpdateUserSelfPut(e)}catch{}},[c,A]=l.useState([]),i=v(),[o,V]=l.useState([]),[U,u]=l.useState(-1),[q,p]=l.useState(""),d=e=>{p(e);const r=i.classesStr.map(t=>({label:t.name,value:t.id}));V(r||[])},N=e=>{var r;u(e),p(((r=o==null?void 0:o.find(t=>t.value==e))==null?void 0:r.label)+"")};return l.useEffect(()=>{d("")},[i.classesStr]),a.jsx(a.Fragment,{children:a.jsxs(s,{layout:"vertical",form:m,onFinish:F,children:[a.jsx(s.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"不能为空"}],children:a.jsx(n,{placeholder:"姓名"})}),a.jsx(s.Item,{name:"userName",label:"工号/学号",rules:[{required:!0,message:"不能为空"}],children:a.jsx(n,{placeholder:"工号/学号"})}),a.jsx(s.Item,{name:"email",label:"email",children:a.jsx(n,{placeholder:"email"})}),a.jsx(s.Item,{name:"phone",label:"手机号",children:a.jsx(n,{placeholder:"手机号"})}),(c==null?void 0:c.includes(R.Student))&&a.jsx(s.Item,{name:["createStudentExt","gradId"],label:"班级",rules:[{required:!0,message:"不能为空"}],style:{display:"none"},children:a.jsx(w,{showSearch:!0,placeholder:"输入搜索班级",onSearch:d,options:o,optionFilterProp:"label",value:U,searchValue:q,onChange:N})}),a.jsx(P,{htmlType:"submit",type:"primary",children:"确认"})]})})};export{L as default};
