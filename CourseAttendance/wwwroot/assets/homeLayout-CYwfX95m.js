import{r as o,C as w,m as T,b as A,k as U,n as V,o as F,j as c,O as K}from"./index-CGvsRVYY.js";import{u as z,U as B}from"./auth-C9xVTXSR.js";import{U as u}from"./httpInstance-D2BGcu-J.js";import{S as P,u as H,L as W,a as q,M as D}from"./index-5q1YvYSh.js";import{M as G}from"./major-Bvyz5Vwm.js";import{t as J,o as Q}from"./Compact-DZ01ldpY.js";import{C as X}from"./index-CmcJMkhA.js";import"./EllipsisOutlined-BFif4AVz.js";import"./Overflow-Dyrp_NYH.js";import"./useVariants-DX1go7si.js";import"./PlusOutlined-O4nhiQfc.js";function Y(t,e,r){return typeof r=="boolean"?r:t.length?!0:J(e).some(a=>a.type===P)}var L=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(r[s[a]]=t[s[a]]);return r};function j(t){let{suffixCls:e,tagName:r,displayName:s}=t;return a=>o.forwardRef((m,f)=>o.createElement(a,Object.assign({ref:f,suffixCls:e,tagName:r},m)))}const v=o.forwardRef((t,e)=>{const{prefixCls:r,suffixCls:s,className:a,tagName:h}=t,m=L(t,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:f}=o.useContext(w),y=f("layout",r),[n,l,i]=H(y),d=s?`${y}-${s}`:y;return n(o.createElement(h,Object.assign({className:A(r||d,a,l,i),ref:e},m)))}),Z=o.forwardRef((t,e)=>{const{direction:r}=o.useContext(w),[s,a]=o.useState([]),{prefixCls:h,className:m,rootClassName:f,children:y,hasSider:n,tagName:l,style:i}=t,d=L(t,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),p=Q(d,["suffixCls"]),{getPrefixCls:C,className:b,style:N}=T("layout"),g=C("layout",h),S=Y(s,y,n),[E,M,R]=H(g),I=A(g,{[`${g}-has-sider`]:S,[`${g}-rtl`]:r==="rtl"},b,m,f,M,R),_=o.useMemo(()=>({siderHook:{addSider:k=>{a(O=>[].concat(U(O),[k]))},removeSider:k=>{a(O=>O.filter($=>$!==k))}}}),[]);return E(o.createElement(W.Provider,{value:_},o.createElement(l,Object.assign({ref:e,className:I,style:Object.assign(Object.assign({},N),i)},p),y)))}),ee=j({tagName:"div",displayName:"Layout"})(Z),se=j({suffixCls:"header",tagName:"header",displayName:"Header"})(v),te=j({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(v),ae=j({suffixCls:"content",tagName:"main",displayName:"Content"})(v),x=ee;x.Header=se;x.Footer=te;x.Content=ae;x.Sider=P;x._InternalSiderContext=q;const re=()=>{const t=V(),e=z(),r=F();o.useEffect(()=>{var l,i,d,p,C,b,N,g,S;const n=[{key:"/home",label:"首页"},{key:"sub1",label:"课堂与考勤",children:[{key:"/courses",label:"课程列表"},...(l=e.user)!=null&&l.roles.includes(u.Student)||(i=e.user)!=null&&i.roles.includes(u.Teacher)?[{key:"/my-courses",label:"我的课程"}]:[],{key:"/attendance",label:"考勤"},...(d=e.user)!=null&&d.roles.includes(u.Teacher)||(p=e.user)!=null&&p.roles.includes(u.Academic)||(C=e.user)!=null&&C.roles.includes(u.Admin)?[{key:"/attendance-batch",label:"考勤批次"}]:[]]},{key:"sub2",label:"设置",children:[...(b=e.user)!=null&&b.roles.includes(u.Academic)||(N=e.user)!=null&&N.roles.includes(u.Admin)?[{key:"/user-manager",label:"用户管理"}]:[],{key:"/modify-pw",label:"修改密码"},{key:"/modify-userinfo",label:"个人信息修改"}]},...(g=e.user)!=null&&g.roles.includes(u.Academic)||(S=e.user)!=null&&S.roles.includes(u.Admin)?[{key:"grades-manager",label:"班级管理",children:[{key:"/majors-category-manager",label:"大专业管理"},{key:"/majors-subcategory-manager",label:"专业管理"},{key:"/classes-manager",label:"班级管理"}]}]:[],{key:"/logout",label:"退出登录"}];a(n),y(n)},[]);const[s,a]=o.useState([]),h=n=>{if(n.key=="/logout"){e.logout();return}t(n.key)},[m,f]=o.useState([]),y=(n=s)=>{const l=n.map(i=>i).find(i=>{var d;return(d=i.children)==null?void 0:d.find(p=>(p==null?void 0:p.key)==r.pathname)});f([...m,(l==null?void 0:l.key)+""])};return c.jsx("div",{children:c.jsx(D,{defaultSelectedKeys:[r.pathname],mode:"inline",theme:"dark",items:s,onSelect:n=>h(n),openKeys:m,onOpenChange:f})})},ge=()=>c.jsx(B,{children:c.jsx(G,{children:c.jsxs(x,{style:{minHeight:"100vh"},children:[c.jsx(P,{collapsible:!0,children:c.jsx(re,{})}),c.jsx(x,{style:{padding:20,minHeight:"100%"},children:c.jsx(X,{style:{width:"100%",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.03), 0 1px 6px -1px rgba(0, 0, 0, 0.32), 0 2px 4px 0 rgba(0, 0, 0, 0.02)",padding:0,background:"#f5f5f5",height:"100%"},variant:"borderless",children:c.jsx(K,{})})})]})})});export{ge as default};
